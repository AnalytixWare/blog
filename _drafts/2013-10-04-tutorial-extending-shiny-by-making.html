---
layout: post
title: Tutorial - Extending Shiny by making an Input/Output Component (no prior knowledge
  of HTML and Javascript required)
date: '2013-10-04T02:50:00.003+10:00'
author: xiaodai
tags:
- Shiny
modified_time: '2013-10-09T15:08:27.378+11:00'
thumbnail: http://1.bp.blogspot.com/-WwqiJjdnwWY/UjiWMpv8nvI/AAAAAAAADUo/1_tikpUE1iA/s72-c/View+Source.png
blogger_id: tag:blogger.com,1999:blog-3081136564986185529.post-8474419098750041628
blogger_orig_url: http://blog.analytixware.com/2013/10/tutorial-extending-shiny-by-making.html
---

I looked at some code by others and I made my first Shiny component - shinyhandsontable! It is both an input and output component. So I thought this is not so hard! To give back to the community I have decide to write a tutorial on how to write a component and teach you all the HTML and JavaScript you will need to know to write it.<br /><div><div><br />If you had tried to read the tutorial by RStudio on extending Shiny (<a href="http://rstudio.github.io/shiny/tutorial/#building-inputs">http://rstudio.github.io/shiny/tutorial/#building-inputs</a>) and did not fully understand it because it's got too much JavaScript and HTML then this tutorial is for you.<br /><br /><b>Disclaimer</b><br /><b><br /></b>Please note that I am quite new to JavaScript and HTML, so what I describe here is not guaranteed to be good JavaScript or HTML practice. This tutorial is meant to help you get started with developing Shiny Components and hopefully can spark your interest so that you are motivated to learn more about JavaScript and HTML, develop more components, and benefit the whole Shiny community as a result.<br /><br />Hopefully if you do learn JavaScript and HTML you will notice what I do as not good practice and feedback to me.<br /><br /><b>Prerequisites</b><br /><br />I have found Shiny to work best in the <a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome </a>browser and this tutorial will be conducted in <a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a>. It's best if you install <a href="https://www.google.com/intl/en/chrome/browser/" target="_blank">Chrome</a> before you start this tutorial.<br /><br /><b>Understand</b></div><div><br />The webpages we see in the web browsers such as Chrome, Firefox and Internet Explorer are all written in HTML (Hypertext Markup Language). You can view the HTML source for&nbsp;the web page by right clicking on somewhere empty and then choosing "View page source".<br /><br />Run the following code in R<br /><br />shiny::runExample("01_hello")<br /><br />and you will see the first Shiny example and right click somewhere empty and select the option <i>View page source&nbsp;</i>will bring up the following HTML source behind the webpage.<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-WwqiJjdnwWY/UjiWMpv8nvI/AAAAAAAADUo/1_tikpUE1iA/s1600/View+Source.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="180" src="http://1.bp.blogspot.com/-WwqiJjdnwWY/UjiWMpv8nvI/AAAAAAAADUo/1_tikpUE1iA/s400/View+Source.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">First Shiny Example</td></tr></tbody></table><br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-inibwvdwFZQ/UjiXUU7QsBI/AAAAAAAADU0/KrLeBUtL5UU/s1600/View+Source+html.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="377" src="http://1.bp.blogspot.com/-inibwvdwFZQ/UjiXUU7QsBI/AAAAAAAADU0/KrLeBUtL5UU/s400/View+Source+html.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The HTML source</td></tr></tbody></table><br /><br />The source contains the HTML that describes how the page looks <i>initially. </i>I say&nbsp;<i>initially&nbsp;</i>because you can use JavaScript to change the HTML while you are browsing the web page and the browser will display the updated HTML with the changes you made. An example is Gmail's loading of the content without you refreshing the page.<br /><br />Simplistically speaking&nbsp;HTML is actually static. It presents you with a page with some text and pictures, like this blog. It doesn't really change and it's not interactive. So how does Shiny deliver interactive content? It's achieved through JavaScript.<br /><br />Essentially Shiny's ui.R file generates the HTML and JavaScript for you. Shiny's server.R uses all the various render<i>xxx</i>&nbsp;functions to turn your R data into the right HTML for display. As you know you can extend Shiny by writing your own R code that generate the right HTML and JavaScript.<br /><br /><b>Some Magic with JavaScript</b><br /><br />Keep you Shiny Example 1 open, in Chrome press Ctrl + Alt + J to bring up the JavaScript console and type in<br /><br /><span style="background-color: white; color: #0080ff; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; white-space: pre-wrap;">$("h1").text("Ni2hao3 Shiny!")</span><br /><span style="background-color: white; color: #0080ff; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; white-space: pre-wrap;"><br /></span>You see what happened? The title changed. This is a bit of magic with JavaScript.<br /><b><br /></b><b>The DOM</b><br /><b><br /></b>When a browser opens up a HTML page it parses the contents, the HTML in the View page source tab, and create a thing call the DOM object. DOM stands for document object model. In a sense the HTML is the DOM object and the DOM object is the HTML in that if you make a change to the DOM the HTML will also change. You can use JavaScript to manipulate the DOM object.<br /><br />The piece of magic I have shown above is an example of manipulating the DOM, specifically I have changed the text of the title. As soon as you change anything in the DOM object the changes will the reflected in the HTML and your browser will render the HTML correctly to show those differences.<br /><br />JavaScript like R is interpreted, meaning you can type code into the console and it gets executed right away. In Chrome press Ctrl + Alt + J to open up the JavaScript console as before. Type <i>console.log("Hello world") </i>and you should see that console.log() is the equivalent of print() in R. This is great if you want to try out some functions.<br /><br /><b>Shiny starts here</b><br /><b><br /></b>I believe this is roughly how Shiny works. It runs the ui.R and generate some HTML based on that. It always puts shiny.js into the HTML.<br /><br />Type this code into the R console<br /><br />shiny::headerPanel("Shiny Component Tutorial!")<br /><br />and you should see a bunch of HTML being generated<br /><br />Each &lt;something&gt;... &lt;/something&gt; is called an element in HTML and something is called a tag.<head> is the head tag and <head>....</head> is called an element. Elements can contain other elements. For example in the above code you should that a h1 tag element is contained with a div tag element.</head></div></div><br />The ui.R in Shiny is nothing more than a set of R code that generates HTML as output. So technically any element you can create in HTML you can create in ui.R<br /><br /><b>jQuery</b><br /><b><br /></b>Javascript libraries is the equivalent of R packages. One of the most popular Javascript libraries is jQuery. It can help you <i>find</i> (or <i>select </i>in JavaScript/CSS terminology) the right elements in the HTML document and perform actions on them. Why do we need to "select" elements? In R you can assign values and objects to variables names so that you can refer to them later. In HTML there is no concept of variable assign, so if you want to manipulate an element of the DOM you need to "select" it and manipulate it, in HTML you can assign ids to tags or if there are unique features to the tags then you can select it.<br /><br />The jQuery library has a super-useful function called jQuery. In fact it's so useful that they have given it an alias $. Unlike in R where $ is not allowed as a part of variable name, in JavaScript $ can be used as a part of a valid variable and function name. On the other hand the . (dot) in R is just another character but in JavaScript (and most other languages) it is use to access a property of the object.<br /><br />If JavaScript was R code then it's like they have done this<br /><br />jQuery = function(...) { ....some awesome code here... }<br />$ = jQuery<br /><br />In R it's common to do plot(object) where the object can be defined by the user and be of classs xyz. The user can define a method called plot.xyz so that when the object is of class xyz calling plot(object) is the same calling plot.xyz(object). In JavaScript it is <i>most likely</i> to be coded as object.plot().<br /><br />To make things simpler I have adapted the page from the <a href="http://rstudio.github.io/shiny/tutorial/#hello-shiny" target="_blank">Hello Shiny</a>&nbsp;example<br /><something class="myShinyComponent"><br /></something><something class="myShinyComponent">ui.R</something><br />library(shiny)<br /><br /># Define UI for application that plots random distributions<br />shinyUI(basicPage(<br /><br />&nbsp; # Application title<br />&nbsp; headerPanel("Shiny Component Tutorial!"),<br /><br />&nbsp; sliderInput("obs",<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Number of observations:",<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; min = 1,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max = 1000,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value = 500)<br />&nbsp; ,<br />&nbsp; # Show a plot of the generated distribution <br />&nbsp; plotOutput("distPlot")<br /><something class="myShinyComponent"></something><br />))<br /><br />server.R<br />library(shiny)<br /><br /># Define server logic required to generate and plot a random distribution<br />shinyServer(function(input, output) {<br /><br />&nbsp; # Expression that generates a plot of the distribution. The expression<br />&nbsp; # is wrapped in a call to renderPlot to indicate that:<br />&nbsp; #<br />&nbsp; # &nbsp;1) It is "reactive" and therefore should be automatically<br />&nbsp; # &nbsp; &nbsp; re-executed when inputs change<br />&nbsp; # &nbsp;2) Its output type is a plot<br />&nbsp; #<br />&nbsp; output$distPlot <- p="" renderplot=""><br />&nbsp; &nbsp; # generate an rnorm distribution and plot it<br />&nbsp; &nbsp; dist <- input="" obs="" p="" rnorm="">&nbsp; &nbsp; hist(dist)<br />&nbsp; })<br />})<br /><b><br /></b>If you now you do run runGist() you should see an ugly looking app like this. In this example you will learn how to make an input component. How to create a shiny component using handsontable and create the input/output component so that the data being plotted would be printed in a table below the graph.<br /><br />I think the best way to learn the basic is to actually not use the ui.R and directly go to the HTML. We will come back later show how to write ui.R code, but for now let's copy the source into the www/index.html location. Make sure now you DELETE the ui.R or the app will run by looking into ui.R instead of index.html<br /><br />Find in HTML the string "distPlot". You will see it in a div tag like this.<!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----><!-----></-></-><br /><div class="MsoNormal"><o:p></o:p></div><b><br /></b><br /><div class="shiny-plot-output" id="distPlot" style="height: 400px; width: 100%;"><div class="console-user-command console-adjacent-user-command-result" style="background-color: white; border-bottom-style: none; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; color: #0080ff; white-space: pre-wrap;">("#distPlot")</span></div><div class="console-message console-log-level console-user-command-result" style="background-color: white; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;">[<span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"></span></span></span></span><br /><ol class="elements-tree-outline outline-disclosure" style="-webkit-padding-start: 12px; box-sizing: border-box; font-size: inherit; line-height: 12px; list-style-type: none; margin: 0px; padding-left: 0px;" tabindex="0"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><li class="parent" draggable="true" style="box-sizing: border-box; margin-left: -12px; margin-top: 1px; padding: 0px 0px 0px 14px; word-wrap: break-word;" title=""><span class="highlight" style="box-sizing: border-box;"><span class="webkit-html-tag" style="box-sizing: border-box; color: #881280;">&lt;<span class="webkit-html-tag-name" style="box-sizing: border-box;">div</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">id</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">distPlot</span>"</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">class</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">shiny-plot-output shiny-bound-output</span>"</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">style</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">width:​ 100% ;​ height:​ 400px</span>"</span>&gt;</span>​<span class="webkit-html-text-node bogus" style="box-sizing: border-box;">…</span>​<span class="webkit-html-tag" style="box-sizing: border-box; color: #881280;">&lt;<span style="box-sizing: border-box;">/div</span>&gt;</span>​</span></li></span></span></span></span></ol><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"></span>]</span></span></span></div><div class="console-message console-log-level console-user-command-result" style="background-color: white; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><br /></span></span></span></div><div class="console-user-command console-adjacent-user-command-result" style="background-color: white; border-bottom-style: none; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; color: #0080ff; white-space: pre-wrap;">$("#distPlot").addClass("testing-shiny")</span></div><div class="console-message console-log-level console-user-command-result" style="background-color: white; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;">[<span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"></span></span></span></span><br /><ol class="elements-tree-outline outline-disclosure" style="-webkit-padding-start: 12px; box-sizing: border-box; font-size: inherit; line-height: 12px; list-style-type: none; margin: 0px; padding-left: 0px;" tabindex="0"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><li class="parent" draggable="true" style="box-sizing: border-box; margin-left: -12px; margin-top: 1px; padding: 0px 0px 0px 14px; word-wrap: break-word;" title=""><span class="highlight" style="box-sizing: border-box;"><span class="webkit-html-tag" style="box-sizing: border-box; color: #881280;">&lt;<span class="webkit-html-tag-name" style="box-sizing: border-box;">div</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">id</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">distPlot</span>"</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">class</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">shiny-plot-output shiny-bound-output testing-shiny</span>"</span> <span class="webkit-html-attribute" style="box-sizing: border-box;"><span class="webkit-html-attribute-name" style="box-sizing: border-box; color: #994500;">style</span>=​"<span class="webkit-html-attribute-value" style="box-sizing: border-box; color: #1a1aa6;">width:​ 100% ;​ height:​ 400px</span>"</span>&gt;</span>​<span class="webkit-html-text-node bogus" style="box-sizing: border-box;">…</span>​<span class="webkit-html-tag" style="box-sizing: border-box; color: #881280;">&lt;<span style="box-sizing: border-box;">/div</span>&gt;</span>​</span></li></span></span></span></span></ol><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><span class="console-formatted-node source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"></span>]</span></span></span></div></div>Even without knowing too much about HTML I am sure you can already deduce a few things by looking at it, for example I can deduce that it has set the height of the plot ot 400 pixels (height: 400px).<br /><br />Now let's open up the JavaScript console and change the HTML. First use $ to find the distPlot. The # means to look for the string distPlot in the id = field. It will return the tag with the id = "distPlot". Technically speaking you can write HTML where two different tags have the same ID but you are not meant to do that. I believe the default behaviour of $ is to return only one such id.<br /><b><br /></b><br /><div class="console-user-command console-adjacent-user-command-result" style="background-color: white; border-bottom-style: none; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><br /></div><div class="console-message console-log-level console-user-command-result" style="background-color: white; border-top-color: rgb(240, 240, 240); border-top-style: solid; border-top-width: 1px; box-sizing: border-box; clear: right; color: #222222; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; margin-left: 24px; min-height: 16px; padding: 1px 22px 1px 0px; position: relative;"><span class="console-message-text source-code" style="box-sizing: border-box; white-space: pre-wrap;"><span style="box-sizing: border-box;"><span class="console-formatted-array source-code" style="box-sizing: border-box; display: inline-block; position: relative; vertical-align: top;"><br /></span></span></span></div>You see how the div tag changed? Now class = has a member called testing-shiny. We have added it via our $ function. Of course this is not very useful for our purpose but it does show how JavaScript can change the DOM and the HTML.<br /><b><br /></b>I also want to show you how to use external JavaScript libraries and I have chosen handsontable as that's the component I have built. You download all you need from here. 